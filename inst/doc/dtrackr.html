<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>dtrackr - Basic operations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">dtrackr - Basic operations</h1>



<div id="tracking-data-provenance" class="section level1">
<h1>Tracking data provenance</h1>
<p>When wrangling complex data sets into a form suitable for analysis
there may be many steps where transformations and filtering of the data
is performed in a data pipeline. At each stage we want to reassure
ourselves that if we have removed data we have done so for the right
reasons, and for scientific publication we need to communicate what
processing the data has undergone, and whether the data processing
unevenly affects the groups we wish to compare. In frequently updated
analyses this must be automated.</p>
<p><code>dtrackr</code> provides a generic capability that can address
this and other problems. By extending the normal data manipulation
functions provided by <code>dplyr</code>, we allow operations on a
dataframe to be recorded as metadata, as the dataframe passes through a
data pipeline, in a “history graph”. We can export the history graph as
a flowchart which helps with documentation, and makes accurate reporting
in the scientific literature simpler.</p>
<p>Tracking the data through the pipeline also allows us a way to
capture where and why data is being excluded, and see both a visual
summary and a detailed line list of exclusions. This can help with
identifying and rectifying data quality issues.</p>
<p>In the situation where data is analysed interactively, as pipeline
code is being created, tracking the history of a dataframe, and
visualising it, allows us to identify if data has been manipulated in
the way we intend, and helps debug pipeline code, or uncover unsupported
assumptions about the data.</p>
<p>There are other places where tracking data provenance could also
help, by visualising the steps an individual data item takes through a
pipeline we can compare different data, such as new versions of data
sets, and quickly validate our data pipeline for use with new data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::load_all()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dtrackr)</span></code></pre></div>
</div>
<div id="basic-operation---comments-and-stratification" class="section level1">
<h1>Basic operation - comments and stratification</h1>
<p>The main documentation for data pipelines is provided by the
<code>comment</code> function. This (and all other functions) uses a
<code>glue</code> package specification to define the comment text. This
glue specification can use a range of variables to describe the data as
it passes through the pipeline. Firstly it can use any global variables
such as <code>filename</code> in this example. Secondly the
<code>.count</code> variable is the number of rows in the current group.
Thirdly the <code>.strata</code> variable is defined to be a description
of the group(s) we are currently in, but in grouped data the grouping
variables (in this case <code>Species</code>) can also be used. Finally
the <code>.total</code> variable returns the whole size of the ungrouped
data-set.</p>
<p>Comments can either be a single <code>.headline</code> or a list of
<code>.messages</code>. Setting either of these to “” disables them for
a given comment. As in the example, thanks to <code>glue</code>, any
expression can be evaluated in the messages but be warned, debugging
them is hard. If an error in the glue spec is present
<code>dtrackr</code> will try and tell you what is the problem was and
what variables should have been available for the glue spec. (N.B. A
common mistake is to use <code>.message</code> rather than
<code>.messages</code> when providing a glue spec.)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::load_all()</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">=</span> <span class="st">&quot;~/tmp/iris.csv&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this is just a pretend example</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># iris = read.csv(filename)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.headline =</span> <span class="st">&quot;Iris data:&quot;</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.messages =</span> <span class="fu">c</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;loaded from </span><span class="sc">\&quot;</span><span class="st">{filename}</span><span class="sc">\&quot;</span><span class="st">&quot;</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;starts with {.count} items&quot;</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.headline =</span> <span class="st">&quot;{.strata}&quot;</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.messages =</span> <span class="fu">c</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;In {Species}&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;there are {.count} items&quot;</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;that is {sprintf(&#39;%1.0f&#39;,.count/.total*100)}% of the total&quot;</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.tag =</span> <span class="st">&quot;note1&quot;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;Final data has {.total} items&quot;</span>, <span class="at">.tag=</span><span class="st">&quot;note2&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="315.000pt" height="235.000pt" viewBox="0 0 315.000 235.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 231.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-230.8 311.1416,-230.8 311.1416,4 -4,4"></polygon>
<!-- 8&#45;&gt;9 -->
<g id="edge1" class="edge">
<title>8:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M153.5708,-41.4C153.5708,-41.4 153.5708,-28.4987 153.5708,-28.4987"></path>
<polygon fill="#000000" stroke="#000000" points="155.3209,-28.4987 153.5708,-23.4987 151.8209,-28.4987 155.3209,-28.4987"></polygon>
</g>
<!-- 5&#45;&gt;8 -->
<g id="edge4" class="edge">
<title>5:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M46.5708,-83.2C46.5708,-83.2 46.5708,-53 46.5708,-53 46.5708,-53 124.2908,-53 124.2908,-53"></path>
<polygon fill="#000000" stroke="#000000" points="124.2909,-54.7501 129.2908,-53 124.2908,-51.2501 124.2909,-54.7501"></polygon>
</g>
<!-- 6&#45;&gt;8 -->
<g id="edge3" class="edge">
<title>6:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M153.5708,-83.2C153.5708,-83.2 153.5708,-70.1777 153.5708,-70.1777"></path>
<polygon fill="#000000" stroke="#000000" points="155.3209,-70.1777 153.5708,-65.1777 151.8209,-70.1778 155.3209,-70.1777"></polygon>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge2" class="edge">
<title>7:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M260.5708,-83.2C260.5708,-83.2 260.5708,-53 260.5708,-53 260.5708,-53 182.8508,-53 182.8508,-53"></path>
<polygon fill="#000000" stroke="#000000" points="182.8508,-51.2501 177.8508,-53 182.8507,-54.7501 182.8508,-51.2501"></polygon>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge7" class="edge">
<title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M46.5708,-147C46.5708,-147 46.5708,-134.4603 46.5708,-134.4603"></path>
<polygon fill="#000000" stroke="#000000" points="48.3209,-134.4603 46.5708,-129.4603 44.8209,-134.4604 48.3209,-134.4603"></polygon>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>3:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M153.5708,-147C153.5708,-147 153.5708,-134.4603 153.5708,-134.4603"></path>
<polygon fill="#000000" stroke="#000000" points="155.3209,-134.4603 153.5708,-129.4603 151.8209,-134.4604 155.3209,-134.4603"></polygon>
</g>
<!-- 4&#45;&gt;7 -->
<g id="edge5" class="edge">
<title>4:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M260.5708,-147C260.5708,-147 260.5708,-134.4603 260.5708,-134.4603"></path>
<polygon fill="#000000" stroke="#000000" points="262.3209,-134.4603 260.5708,-129.4603 258.8209,-134.4604 262.3209,-134.4603"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge10" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M110.5602,-188.8C110.5602,-188.8 110.5602,-159 110.5602,-159 110.5602,-159 91.0032,-159 91.0032,-159"></path>
<polygon fill="#000000" stroke="#000000" points="91.0033,-157.2501 86.0032,-159 91.0032,-160.7501 91.0033,-157.2501"></polygon>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge9" class="edge">
<title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M153.5708,-188.8C153.5708,-188.8 153.5708,-175.7777 153.5708,-175.7777"></path>
<polygon fill="#000000" stroke="#000000" points="155.3209,-175.7777 153.5708,-170.7777 151.8209,-175.7778 155.3209,-175.7777"></polygon>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge8" class="edge">
<title>1:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M196.5814,-188.8C196.5814,-188.8 196.5814,-159 196.5814,-159 196.5814,-159 216.1384,-159 216.1384,-159"></path>
<polygon fill="#000000" stroke="#000000" points="216.1384,-160.7501 221.1384,-159 216.1383,-157.2501 216.1384,-160.7501"></polygon>
</g>
<!-- 9 -->
<g id="node1" class="node">
<title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="204.2053,-23.4033 102.9363,-23.4033 102.9363,-.1967 204.2053,-.1967 204.2053,-23.4033"></polygon>
<text text-anchor="start" x="110.0036" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">Final data has 150 items</text>
</g>
<!-- 8 -->
<g id="node2" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="177.7455,-65.0033 129.3961,-65.0033 129.3961,-41.7967 177.7455,-41.7967 177.7455,-65.0033"></polygon>
<text text-anchor="start" x="136.234" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text>
</g>
<!-- 5 -->
<g id="node3" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="93.2125,-129.2 -.0709,-129.2 -.0709,-83.2 93.2125,-83.2 93.2125,-129.2"></polygon>
<text text-anchor="start" x="7" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="7" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In setosa</text>
<text text-anchor="start" x="7" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text>
<text text-anchor="start" x="7" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text>
</g>
<!-- 6 -->
<g id="node4" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="200.2125,-129.2 106.9291,-129.2 106.9291,-83.2 200.2125,-83.2 200.2125,-129.2"></polygon>
<text text-anchor="start" x="114" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="114" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In versicolor</text>
<text text-anchor="start" x="114" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text>
<text text-anchor="start" x="114" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text>
</g>
<!-- 7 -->
<g id="node5" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="307.2125,-129.2 213.9291,-129.2 213.9291,-83.2 307.2125,-83.2 307.2125,-129.2"></polygon>
<text text-anchor="start" x="221" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="221" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In virginica</text>
<text text-anchor="start" x="221" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text>
<text text-anchor="start" x="221" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text>
</g>
<!-- 2 -->
<g id="node6" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="85.9717,-170.6033 7.1699,-170.6033 7.1699,-147.3967 85.9717,-147.3967 85.9717,-170.6033"></polygon>
<text text-anchor="start" x="14.1204" y="-156.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 3 -->
<g id="node7" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="192.9717,-170.6033 114.1699,-170.6033 114.1699,-147.3967 192.9717,-147.3967 192.9717,-170.6033"></polygon>
<text text-anchor="start" x="121.1204" y="-156.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 4 -->
<g id="node8" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="299.9717,-170.6033 221.1699,-170.6033 221.1699,-147.3967 299.9717,-147.3967 299.9717,-170.6033"></polygon>
<text text-anchor="start" x="228.1204" y="-156.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 1 -->
<g id="node9" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="209.0916,-226.8 98.05,-226.8 98.05,-188.8 209.0916,-188.8 209.0916,-226.8"></polygon>
<text text-anchor="start" x="105.0604" y="-213.6" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Iris data:</text>
<text text-anchor="start" x="105.0604" y="-205.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">loaded from &quot;~/tmp/iris.csv&quot;</text>
<text text-anchor="start" x="105.0604" y="-197.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text>
</g>
</g>
</svg>

</div>
<div id="status---further-analysis-in-the-workflow" class="section level1">
<h1>Status - Further analysis in the workflow</h1>
<p>In the middle of a pipeline you may wish to document something about
the data that is more complex than the simple counts.
<code>comment</code> has a more sophisticated counterpart
<code>status</code>. <code>status</code> is essentially a
<code>dplyr</code> summarisation step which is connected to a
<code>glue</code> specification output, that is recorded in the data
frame history. In plain English this means you can do an arbitrary
summarisation and put the result into the flowchart, without
interrupting the data flow, for example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>(<span class="st">&quot;starts with {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">status</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">petalMean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%1.1f&quot;</span>, <span class="fu">mean</span>(Petal.Width)),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">petalSd =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%1.1f&quot;</span>, <span class="fu">sd</span>(Petal.Width)),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.messages =</span> <span class="fu">c</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;In {Species} the petals are&quot;</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;on average {petalMean} \u00B1 {petalSd} cms wide&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>(<span class="at">.messages =</span> <span class="st">&quot;ends with {.total} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="414.000pt" height="171.000pt" viewBox="0 0 414.000 171.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 167.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-166.8 409.5864,-166.8 409.5864,4 -4,4"></polygon>
<!-- 5&#45;&gt;8 -->
<g id="edge3" class="edge">
<title>5:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M62.7932,-41.6C62.7932,-41.6 62.7932,-11 62.7932,-11 62.7932,-11 155.4087,-11 155.4087,-11"></path>
<polygon fill="#000000" stroke="#000000" points="155.4087,-12.7501 160.4087,-11 155.4086,-9.2501 155.4087,-12.7501"></polygon>
</g>
<!-- 6&#45;&gt;8 -->
<g id="edge2" class="edge">
<title>6:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M202.7932,-41.6C202.7932,-41.6 202.7932,-28.5777 202.7932,-28.5777"></path>
<polygon fill="#000000" stroke="#000000" points="204.5433,-28.5777 202.7932,-23.5777 201.0433,-28.5778 204.5433,-28.5777"></polygon>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge1" class="edge">
<title>7:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M342.7932,-41.6C342.7932,-41.6 342.7932,-11 342.7932,-11 342.7932,-11 250.1777,-11 250.1777,-11"></path>
<polygon fill="#000000" stroke="#000000" points="250.1778,-9.2501 245.1777,-11 250.1777,-12.7501 250.1778,-9.2501"></polygon>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge6" class="edge">
<title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M62.7932,-97.4C62.7932,-97.4 62.7932,-84.8622 62.7932,-84.8622"></path>
<polygon fill="#000000" stroke="#000000" points="64.5433,-84.8622 62.7932,-79.8622 61.0433,-84.8623 64.5433,-84.8622"></polygon>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge5" class="edge">
<title>3:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M202.7932,-97.4C202.7932,-97.4 202.7932,-84.8622 202.7932,-84.8622"></path>
<polygon fill="#000000" stroke="#000000" points="204.5433,-84.8622 202.7932,-79.8622 201.0433,-84.8623 204.5433,-84.8622"></polygon>
</g>
<!-- 4&#45;&gt;7 -->
<g id="edge4" class="edge">
<title>4:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M342.7932,-97.4C342.7932,-97.4 342.7932,-84.8622 342.7932,-84.8622"></path>
<polygon fill="#000000" stroke="#000000" points="344.5433,-84.8622 342.7932,-79.8622 341.0433,-84.8623 344.5433,-84.8622"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge9" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M202.7932,-151C202.7932,-151 62.7932,-151 62.7932,-151 62.7932,-151 62.7932,-126.2096 62.7932,-126.2096"></path>
<polygon fill="#000000" stroke="#000000" points="64.5433,-126.2096 62.7932,-121.2096 61.0433,-126.2097 64.5433,-126.2096"></polygon>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge8" class="edge">
<title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M202.7932,-139C202.7932,-139 202.7932,-126.0987 202.7932,-126.0987"></path>
<polygon fill="#000000" stroke="#000000" points="204.5433,-126.0987 202.7932,-121.0987 201.0433,-126.0987 204.5433,-126.0987"></polygon>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge7" class="edge">
<title>1:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M202.7932,-151C202.7932,-151 342.7932,-151 342.7932,-151 342.7932,-151 342.7932,-126.2096 342.7932,-126.2096"></path>
<polygon fill="#000000" stroke="#000000" points="344.5433,-126.2096 342.7932,-121.2096 341.0433,-126.2097 344.5433,-126.2096"></polygon>
</g>
<!-- 8 -->
<g id="node1" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="244.9762,-23.4033 160.6102,-23.4033 160.6102,-.1967 244.9762,-.1967 244.9762,-23.4033"></polygon>
<text text-anchor="start" x="167.452" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 150 items</text>
</g>
<!-- 5 -->
<g id="node2" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="125.3803,-79.6 .2061,-79.6 .2061,-41.6 125.3803,-41.6 125.3803,-79.6"></polygon>
<text text-anchor="start" x="7" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="7" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In setosa the petals are</text>
<text text-anchor="start" x="7" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 0.2 ± 0.1 cms wide</text>
</g>
<!-- 6 -->
<g id="node3" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="265.3803,-79.6 140.2061,-79.6 140.2061,-41.6 265.3803,-41.6 265.3803,-79.6"></polygon>
<text text-anchor="start" x="147" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="147" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In versicolor the petals are</text>
<text text-anchor="start" x="147" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 1.3 ± 0.2 cms wide</text>
</g>
<!-- 7 -->
<g id="node4" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="405.3803,-79.6 280.2061,-79.6 280.2061,-41.6 405.3803,-41.6 405.3803,-79.6"></polygon>
<text text-anchor="start" x="287" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="287" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In virginica the petals are</text>
<text text-anchor="start" x="287" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 2.0 ± 0.3 cms wide</text>
</g>
<!-- 2 -->
<g id="node5" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="102.1941,-121.0033 23.3923,-121.0033 23.3923,-97.7967 102.1941,-97.7967 102.1941,-121.0033"></polygon>
<text text-anchor="start" x="30.3428" y="-107" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 3 -->
<g id="node6" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="242.1941,-121.0033 163.3923,-121.0033 163.3923,-97.7967 242.1941,-97.7967 242.1941,-121.0033"></polygon>
<text text-anchor="start" x="170.3428" y="-107" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 4 -->
<g id="node7" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="382.1941,-121.0033 303.3923,-121.0033 303.3923,-97.7967 382.1941,-97.7967 382.1941,-121.0033"></polygon>
<text text-anchor="start" x="310.3428" y="-107" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 1 -->
<g id="node8" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="246.1909,-162.6033 159.3955,-162.6033 159.3955,-139.3967 246.1909,-139.3967 246.1909,-162.6033"></polygon>
<text text-anchor="start" x="166.3444" y="-148.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text>
</g>
</g>
</svg>

<p>A frequent use case for a more detailed description is to have a
subgroup count within a flowchart. This is different enough to have its
own function <code>count_subgroup()</code>. This works best for factor
subgroup columns but other data will be converted to a factor
automatically. As this uses glue specifications a modified formatted
output is also possible as in this example, where the subgroup
percentages are calculated to 1 decimal place.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count_subgroup</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    color,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.messages =</span> <span class="st">&quot;colour {.name}: {sprintf(&#39;%1.1f%%&#39;, {.count}/{.subtotal}*100)}&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="419.000pt" height="211.000pt" viewBox="0 0 419.000 211.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 207.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-206.8 415.3488,-206.8 415.3488,4 -4,4"></polygon>
<!-- 7&#45;&gt;12 -->
<g id="edge5" class="edge">
<title>7:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M35.6744,-41.6C35.6744,-41.6 35.6744,-7 35.6744,-7 35.6744,-7 171.8362,-7 171.8362,-7"></path>
<polygon fill="#000000" stroke="#000000" points="171.8363,-8.7501 176.8362,-7 171.8362,-5.2501 171.8363,-8.7501"></polygon>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge4" class="edge">
<title>8:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M120.6744,-41.6C120.6744,-41.6 120.6744,-15 120.6744,-15 120.6744,-15 171.8973,-15 171.8973,-15"></path>
<polygon fill="#000000" stroke="#000000" points="171.8973,-16.7501 176.8973,-15 171.8972,-13.2501 171.8973,-16.7501"></polygon>
</g>
<!-- 9&#45;&gt;12 -->
<g id="edge3" class="edge">
<title>9:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M205.6744,-41.6C205.6744,-41.6 205.6744,-28.5777 205.6744,-28.5777"></path>
<polygon fill="#000000" stroke="#000000" points="207.4245,-28.5777 205.6744,-23.5777 203.9245,-28.5778 207.4245,-28.5777"></polygon>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge2" class="edge">
<title>10:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M290.6744,-41.6C290.6744,-41.6 290.6744,-15 290.6744,-15 290.6744,-15 239.4515,-15 239.4515,-15"></path>
<polygon fill="#000000" stroke="#000000" points="239.4516,-13.2501 234.4515,-15 239.4515,-16.7501 239.4516,-13.2501"></polygon>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge1" class="edge">
<title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M375.6744,-41.6C375.6744,-41.6 375.6744,-7 375.6744,-7 375.6744,-7 239.5126,-7 239.5126,-7"></path>
<polygon fill="#000000" stroke="#000000" points="239.5126,-5.2501 234.5126,-7 239.5125,-8.7501 239.5126,-5.2501"></polygon>
</g>
<!-- 2&#45;&gt;7 -->
<g id="edge10" class="edge">
<title>2:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M35.6744,-137.4C35.6744,-137.4 35.6744,-124.7395 35.6744,-124.7395"></path>
<polygon fill="#000000" stroke="#000000" points="37.4245,-124.7394 35.6744,-119.7395 33.9245,-124.7395 37.4245,-124.7394"></polygon>
</g>
<!-- 3&#45;&gt;8 -->
<g id="edge9" class="edge">
<title>3:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M120.6744,-137.4C120.6744,-137.4 120.6744,-124.7395 120.6744,-124.7395"></path>
<polygon fill="#000000" stroke="#000000" points="122.4245,-124.7394 120.6744,-119.7395 118.9245,-124.7395 122.4245,-124.7394"></polygon>
</g>
<!-- 4&#45;&gt;9 -->
<g id="edge8" class="edge">
<title>4:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M205.6744,-137.4C205.6744,-137.4 205.6744,-124.7395 205.6744,-124.7395"></path>
<polygon fill="#000000" stroke="#000000" points="207.4245,-124.7394 205.6744,-119.7395 203.9245,-124.7395 207.4245,-124.7394"></polygon>
</g>
<!-- 5&#45;&gt;10 -->
<g id="edge7" class="edge">
<title>5:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M290.6744,-137.4C290.6744,-137.4 290.6744,-124.7395 290.6744,-124.7395"></path>
<polygon fill="#000000" stroke="#000000" points="292.4245,-124.7394 290.6744,-119.7395 288.9245,-124.7395 292.4245,-124.7394"></polygon>
</g>
<!-- 6&#45;&gt;11 -->
<g id="edge6" class="edge">
<title>6:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M375.6744,-137.4C375.6744,-137.4 375.6744,-124.7395 375.6744,-124.7395"></path>
<polygon fill="#000000" stroke="#000000" points="377.4245,-124.7394 375.6744,-119.7395 373.9245,-124.7395 377.4245,-124.7394"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge15" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M205.6744,-194C205.6744,-194 35.6744,-194 35.6744,-194 35.6744,-194 35.6744,-166.1181 35.6744,-166.1181"></path>
<polygon fill="#000000" stroke="#000000" points="37.4245,-166.1181 35.6744,-161.1181 33.9245,-166.1182 37.4245,-166.1181"></polygon>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge14" class="edge">
<title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M205.6744,-187C205.6744,-187 120.6744,-187 120.6744,-187 120.6744,-187 120.6744,-166.2969 120.6744,-166.2969"></path>
<polygon fill="#000000" stroke="#000000" points="122.4245,-166.2968 120.6744,-161.2969 118.9245,-166.2969 122.4245,-166.2968"></polygon>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge13" class="edge">
<title>1:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M205.6744,-179C205.6744,-179 205.6744,-166.0987 205.6744,-166.0987"></path>
<polygon fill="#000000" stroke="#000000" points="207.4245,-166.0987 205.6744,-161.0987 203.9245,-166.0987 207.4245,-166.0987"></polygon>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge12" class="edge">
<title>1:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M205.6744,-187C205.6744,-187 290.6744,-187 290.6744,-187 290.6744,-187 290.6744,-166.2969 290.6744,-166.2969"></path>
<polygon fill="#000000" stroke="#000000" points="292.4245,-166.2968 290.6744,-161.2969 288.9245,-166.2969 292.4245,-166.2968"></polygon>
</g>
<!-- 1&#45;&gt;6 -->
<g id="edge11" class="edge">
<title>1:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M205.6744,-194C205.6744,-194 375.6744,-194 375.6744,-194 375.6744,-194 375.6744,-166.1181 375.6744,-166.1181"></path>
<polygon fill="#000000" stroke="#000000" points="377.4245,-166.1181 375.6744,-161.1181 373.9245,-166.1182 377.4245,-166.1181"></polygon>
</g>
<!-- 12 -->
<g id="node1" class="node">
<title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="234.244,-23.4033 177.1048,-23.4033 177.1048,-.1967 234.244,-.1967 234.244,-23.4033"></polygon>
<text text-anchor="start" x="183.8904" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">53940 items</text>
</g>
<!-- 7 -->
<g id="node2" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="71.5241,-119.6 -.1753,-119.6 -.1753,-41.6 71.5241,-41.6 71.5241,-119.6"></polygon>
<text text-anchor="start" x="7" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Fair</text>
<text text-anchor="start" x="7" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 10.1%</text>
<text text-anchor="start" x="7" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 13.9%</text>
<text text-anchor="start" x="7" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 19.4%</text>
<text text-anchor="start" x="7" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 19.5%</text>
<text text-anchor="start" x="7" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 18.8%</text>
<text text-anchor="start" x="7" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.9%</text>
<text text-anchor="start" x="7" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 7.4%</text>
</g>
<!-- 8 -->
<g id="node3" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="156.5241,-119.6 84.8247,-119.6 84.8247,-41.6 156.5241,-41.6 156.5241,-119.6"></polygon>
<text text-anchor="start" x="92" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Good</text>
<text text-anchor="start" x="92" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 13.5%</text>
<text text-anchor="start" x="92" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 19.0%</text>
<text text-anchor="start" x="92" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 18.5%</text>
<text text-anchor="start" x="92" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 17.8%</text>
<text text-anchor="start" x="92" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 14.3%</text>
<text text-anchor="start" x="92" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.6%</text>
<text text-anchor="start" x="92" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 6.3%</text>
</g>
<!-- 9 -->
<g id="node4" class="node">
<title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="241.5241,-119.6 169.8247,-119.6 169.8247,-41.6 241.5241,-41.6 241.5241,-119.6"></polygon>
<text text-anchor="start" x="177" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Ideal</text>
<text text-anchor="start" x="177" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 13.2%</text>
<text text-anchor="start" x="177" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 18.1%</text>
<text text-anchor="start" x="177" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 17.8%</text>
<text text-anchor="start" x="177" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 22.7%</text>
<text text-anchor="start" x="177" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 14.5%</text>
<text text-anchor="start" x="177" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 9.7%</text>
<text text-anchor="start" x="177" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 4.2%</text>
</g>
<!-- 10 -->
<g id="node5" class="node">
<title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="326.5241,-119.6 254.8247,-119.6 254.8247,-41.6 326.5241,-41.6 326.5241,-119.6"></polygon>
<text text-anchor="start" x="262" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Premium</text>
<text text-anchor="start" x="262" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 11.6%</text>
<text text-anchor="start" x="262" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 16.9%</text>
<text text-anchor="start" x="262" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 16.9%</text>
<text text-anchor="start" x="262" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 21.2%</text>
<text text-anchor="start" x="262" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 17.1%</text>
<text text-anchor="start" x="262" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.4%</text>
<text text-anchor="start" x="262" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 5.9%</text>
</g>
<!-- 11 -->
<g id="node6" class="node">
<title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="411.5241,-119.6 339.8247,-119.6 339.8247,-41.6 411.5241,-41.6 411.5241,-119.6"></polygon>
<text text-anchor="start" x="347" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Very Good</text>
<text text-anchor="start" x="347" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 12.5%</text>
<text text-anchor="start" x="347" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 19.9%</text>
<text text-anchor="start" x="347" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 17.9%</text>
<text text-anchor="start" x="347" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 19.0%</text>
<text text-anchor="start" x="347" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 15.1%</text>
<text text-anchor="start" x="347" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.0%</text>
<text text-anchor="start" x="347" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 5.6%</text>
</g>
<!-- 2 -->
<g id="node7" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="66.2937,-161.0033 5.0551,-161.0033 5.0551,-137.7967 66.2937,-137.7967 66.2937,-161.0033"></polygon>
<text text-anchor="start" x="12.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text>
</g>
<!-- 3 -->
<g id="node8" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="151.2937,-161.0033 90.0551,-161.0033 90.0551,-137.7967 151.2937,-137.7967 151.2937,-161.0033"></polygon>
<text text-anchor="start" x="97.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text>
</g>
<!-- 4 -->
<g id="node9" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="236.2937,-161.0033 175.0551,-161.0033 175.0551,-137.7967 236.2937,-137.7967 236.2937,-161.0033"></polygon>
<text text-anchor="start" x="182.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text>
</g>
<!-- 5 -->
<g id="node10" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="321.2937,-161.0033 260.0551,-161.0033 260.0551,-137.7967 321.2937,-137.7967 321.2937,-161.0033"></polygon>
<text text-anchor="start" x="267.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text>
</g>
<!-- 6 -->
<g id="node11" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="406.2937,-161.0033 345.0551,-161.0033 345.0551,-137.7967 406.2937,-137.7967 406.2937,-161.0033"></polygon>
<text text-anchor="start" x="352.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text>
</g>
<!-- 1 -->
<g id="node12" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="234.244,-202.6033 177.1048,-202.6033 177.1048,-179.3967 234.244,-179.3967 234.244,-202.6033"></polygon>
<text text-anchor="start" x="183.8904" y="-188.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">53940 items</text>
</g>
</g>
</svg>

</div>
<div id="filtering-exclusions-and-inclusions" class="section level1">
<h1>Filtering, exclusions and inclusions</h1>
<p>Documenting the data set is only useful if you can also manipulate
it, and one part of this is including and excluding things we don’t
want. The standard <code>dplyr::filter</code> approach works for this,
and we can use the before and after <code>.count.in</code> and
<code>.count.out</code>, and the difference between the two
<code>.excluded</code> to document what the result was.</p>
<p>In this example we exclude items that are more than one standard
deviation above the mean. The default message
(<code>.messages = &quot;excluded {.excluded} items&quot;</code>) has been left as
is which simply returns how many things have been excluded. With no
customization the goal is for the pipeline to look as much as possible
like a <code>dplyr</code> pipeline and it should be possible to take a
normal <code>dplyr</code> pipeline and insert <code>track()</code> at
the front and <code>flowchart()</code> at the end to get a documented
pipeline.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    Petal.Width <span class="sc">&lt;</span> <span class="fu">mean</span>(Petal.Width)<span class="sc">+</span><span class="fu">sd</span>(Petal.Width)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="424.800pt" height="95.187pt" viewBox="0 0 424.800 95.187" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.787 0.787) rotate(0) translate(4 117.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-117.2 536.4572,-117.2 536.4572,4 -4,4"></polygon>
<!-- 2&#45;&gt;8 -->
<g id="edge3" class="edge">
<title>2:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M39.4504,-44.6C39.4504,-44.6 39.4504,-11 39.4504,-11 39.4504,-11 190.1748,-11 190.1748,-11"></path>
<polygon fill="#000000" stroke="#000000" points="190.1748,-12.7501 195.1748,-11 190.1748,-9.2501 190.1748,-12.7501"></polygon>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge6" class="edge">
<title>2:e-&gt;5</title>
<path fill="none" stroke="#000000" d="M78.4504,-56C78.4504,-56 87.3864,-56 87.3864,-56"></path>
<polygon fill="#000000" stroke="#000000" points="87.3864,-57.7501 92.3864,-56 87.3863,-54.2501 87.3864,-57.7501"></polygon>
</g>
<!-- 3&#45;&gt;8 -->
<g id="edge2" class="edge">
<title>3:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M219.4504,-44.6C219.4504,-44.6 219.4504,-28.6416 219.4504,-28.6416"></path>
<polygon fill="#000000" stroke="#000000" points="221.2005,-28.6415 219.4504,-23.6416 217.7005,-28.6416 221.2005,-28.6415"></polygon>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge5" class="edge">
<title>3:e-&gt;6</title>
<path fill="none" stroke="#000000" d="M258.4504,-56C258.4504,-56 267.9214,-56 267.9214,-56"></path>
<polygon fill="#000000" stroke="#000000" points="267.9214,-57.7501 272.9214,-56 267.9214,-54.2501 267.9214,-57.7501"></polygon>
</g>
<!-- 4&#45;&gt;8 -->
<g id="edge1" class="edge">
<title>4:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M405.4504,-44.6C405.4504,-44.6 405.4504,-11 405.4504,-11 405.4504,-11 248.7667,-11 248.7667,-11"></path>
<polygon fill="#000000" stroke="#000000" points="248.7667,-9.2501 243.7667,-11 248.7666,-12.7501 248.7667,-9.2501"></polygon>
</g>
<!-- 4&#45;&gt;7 -->
<g id="edge4" class="edge">
<title>4:e-&gt;7</title>
<path fill="none" stroke="#000000" d="M444.4504,-56C444.4504,-56 453.3864,-56 453.3864,-56"></path>
<polygon fill="#000000" stroke="#000000" points="453.3864,-57.7501 458.3864,-56 453.3863,-54.2501 453.3864,-57.7501"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge9" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M219.4504,-101C219.4504,-101 39.4504,-101 39.4504,-101 39.4504,-101 39.4504,-73.2656 39.4504,-73.2656"></path>
<polygon fill="#000000" stroke="#000000" points="41.2005,-73.2655 39.4504,-68.2656 37.7005,-73.2656 41.2005,-73.2655"></polygon>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge8" class="edge">
<title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M219.4504,-89.4C219.4504,-89.4 219.4504,-73.4416 219.4504,-73.4416"></path>
<polygon fill="#000000" stroke="#000000" points="221.2005,-73.4415 219.4504,-68.4416 217.7005,-73.4416 221.2005,-73.4415"></polygon>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge7" class="edge">
<title>1:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M219.4504,-101C219.4504,-101 405.4504,-101 405.4504,-101 405.4504,-101 405.4504,-73.2656 405.4504,-73.2656"></path>
<polygon fill="#000000" stroke="#000000" points="407.2005,-73.2655 405.4504,-68.2656 403.7005,-73.2656 407.2005,-73.2655"></polygon>
</g>
<!-- 8 -->
<g id="node1" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="243.6251,-23.4033 195.2757,-23.4033 195.2757,-.1967 243.6251,-.1967 243.6251,-23.4033"></polygon>
<text text-anchor="start" x="202.1136" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">130 items</text>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="78.8513,-68.2033 .0495,-68.2033 .0495,-44.9967 78.8513,-44.9967 78.8513,-68.2033"></polygon>
<text text-anchor="start" x="7" y="-54.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="258.8513,-68.2033 180.0495,-68.2033 180.0495,-44.9967 258.8513,-44.9967 258.8513,-68.2033"></polygon>
<text text-anchor="start" x="187" y="-54.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="444.8513,-68.2033 366.0495,-68.2033 366.0495,-44.9967 444.8513,-44.9967 444.8513,-68.2033"></polygon>
<text text-anchor="start" x="373" y="-54.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 5 -->
<g id="node5" class="node">
<title>5</title>
<polygon fill="#cccccc" stroke="#000000" points="166.464,-71.6 92.4368,-71.6 92.4368,-41.6 166.464,-41.6 166.464,-71.6"></polygon>
<text text-anchor="start" x="99.4436" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="99.4436" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 9 items</text>
</g>
<!-- 6 -->
<g id="node6" class="node">
<title>6</title>
<polygon fill="#cccccc" stroke="#000000" points="351.8441,-71.6 273.0567,-71.6 273.0567,-41.6 351.8441,-41.6 351.8441,-71.6"></polygon>
<text text-anchor="start" x="280.0036" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="280.0036" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 5 items</text>
</g>
<!-- 7 -->
<g id="node7" class="node">
<title>7</title>
<polygon fill="#cccccc" stroke="#000000" points="532.464,-71.6 458.4368,-71.6 458.4368,-41.6 532.464,-41.6 532.464,-71.6"></polygon>
<text text-anchor="start" x="465.4436" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="465.4436" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 6 items</text>
</g>
<!-- 1 -->
<g id="node8" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="243.6251,-113.0033 195.2757,-113.0033 195.2757,-89.7967 243.6251,-89.7967 243.6251,-113.0033"></polygon>
<text text-anchor="start" x="202.1136" y="-99" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text>
</g>
</g>
</svg>

<p>This is useful but the reason for exclusion is not as clear as we
would like, and this does not scale particularly well to multiple
criteria, which are typical of the filters needed to massage real life
data. For this we have written <code>exclude_all</code> which takes
multiple criteria and applies them in parallel, combining the result at
the end, after documenting their individual effects. Rather than the
logical expression expected by <code>dplyr::filter</code> we provide
matching criteria as a formula relating the filtering criteria on the
left hand side, to the glue specification on the right hand side (a
trick inspired by <code>dplyr::case_when()</code>’s syntax). This is
very much slower than <code>filter</code> but gives fine control over
the output.</p>
<p>The logic of <code>exclude_all()</code> is reversed compared to
<code>dplyr::filter()</code>. In <code>filter()</code> only items for
which the filtering criteria is TRUE are INCLUDED. In this example there
are no missing values, however the behaviour of the
<code>filter()</code> when the criteria cannot be evaluated and
<code>NA</code> values are generated is to exclude them.</p>
<p>In <code>exclude_all()</code> there can be multiple criteria and ALL
items that match any of the criteria are EXCLUDED. If a particular
criteria cannot be evaluated for a data item the behaviour of
<code>exclude_all()</code> is controlled by the <code>na.rm</code>
parameter. This defaults to FALSE which means that any values that
cannot be evaluated are <strong>NOT</strong> excluded.</p>
<p>For each different criteria the number of items excluded is recorded
in the history graph in a manner defined by the right hand side of the
exclusion criteria formulae.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="ot">=</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;starts with {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exclude_all</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    Species<span class="sc">==</span><span class="st">&quot;versicolor&quot;</span> <span class="sc">~</span> <span class="st">&quot;removing {.excluded} versicolor&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;{Species} has {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exclude_all</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    Petal.Width <span class="sc">&gt;</span> <span class="fu">mean</span>(Petal.Width)<span class="sc">+</span><span class="fu">sd</span>(Petal.Width) <span class="sc">~</span> <span class="st">&quot;{.excluded} with petals &gt; 1 SD wider than the mean&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    Petal.Length <span class="sc">&gt;</span> <span class="fu">mean</span>(Petal.Length)<span class="sc">+</span><span class="fu">sd</span>(Petal.Length) <span class="sc">~</span> <span class="st">&quot;{.excluded} with petals &gt; 1 SD longer than the mean&quot;</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    Sepal.Width <span class="sc">&gt;</span> <span class="fu">mean</span>(Sepal.Width)<span class="sc">+</span><span class="fu">sd</span>(Sepal.Width) <span class="sc">~</span> <span class="st">&quot;{.excluded} with sepals &gt; 1 SD wider than the mean&quot;</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    Sepal.Length <span class="sc">&gt;</span> <span class="fu">mean</span>(Sepal.Length)<span class="sc">+</span><span class="fu">sd</span>(Sepal.Length) <span class="sc">~</span> <span class="st">&quot;{.excluded} with sepals &gt; 1 SD longer than the mean&quot;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;{Species} now has {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;ends with {.total} items&quot;</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="sc">%&gt;%</span> <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="424.800pt" height="237.828pt" viewBox="0 0 424.800 237.828" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.748 0.748) rotate(0) translate(4 314.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-314 564.4808,-314 564.4808,4 -4,4"></polygon>
<!-- 12&#45;&gt;13 -->
<g id="edge1" class="edge">
<title>12:s-&gt;13</title>
<path fill="none" stroke="#000000" d="M193.0124,-41.4C193.0124,-41.4 193.0124,-28.4987 193.0124,-28.4987"></path>
<polygon fill="#000000" stroke="#000000" points="194.7625,-28.4987 193.0124,-23.4987 191.2625,-28.4987 194.7625,-28.4987"></polygon>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge3" class="edge">
<title>10:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M51.0124,-93C51.0124,-93 185.6413,-93 185.6413,-93 185.6413,-93 185.6413,-70.0671 185.6413,-70.0671"></path>
<polygon fill="#000000" stroke="#000000" points="187.3914,-70.0671 185.6413,-65.0671 183.8914,-70.0672 187.3914,-70.0671"></polygon>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge2" class="edge">
<title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M336.0124,-103C336.0124,-103 200.3835,-103 200.3835,-103 200.3835,-103 200.3835,-70.1545 200.3835,-70.1545"></path>
<polygon fill="#000000" stroke="#000000" points="202.1336,-70.1545 200.3835,-65.1545 198.6336,-70.1545 202.1336,-70.1545"></polygon>
</g>
<!-- 6&#45;&gt;10 -->
<g id="edge5" class="edge">
<title>6:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M51.0124,-143.2C51.0124,-143.2 51.0124,-118.4349 51.0124,-118.4349"></path>
<polygon fill="#000000" stroke="#000000" points="52.7625,-118.4349 51.0124,-113.4349 49.2625,-118.435 52.7625,-118.4349"></polygon>
</g>
<!-- 6&#45;&gt;8 -->
<g id="edge7" class="edge">
<title>6:e-&gt;8</title>
<path fill="none" stroke="#000000" d="M94.0124,-158C94.0124,-158 102.2291,-158 102.2291,-158"></path>
<polygon fill="#000000" stroke="#000000" points="102.2292,-159.7501 107.2291,-158 102.2291,-156.2501 102.2292,-159.7501"></polygon>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge4" class="edge">
<title>7:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M336.0124,-143.2C336.0124,-143.2 336.0124,-118.4349 336.0124,-118.4349"></path>
<polygon fill="#000000" stroke="#000000" points="337.7625,-118.4349 336.0124,-113.4349 334.2625,-118.435 337.7625,-118.4349"></polygon>
</g>
<!-- 7&#45;&gt;9 -->
<g id="edge6" class="edge">
<title>7:e-&gt;9</title>
<path fill="none" stroke="#000000" d="M381.0124,-158C381.0124,-158 390.3251,-158 390.3251,-158"></path>
<polygon fill="#000000" stroke="#000000" points="390.3251,-159.7501 395.3251,-158 390.325,-156.2501 390.3251,-159.7501"></polygon>
</g>
<!-- 4&#45;&gt;6 -->
<g id="edge9" class="edge">
<title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M51.0124,-203C51.0124,-203 51.0124,-178.3672 51.0124,-178.3672"></path>
<polygon fill="#000000" stroke="#000000" points="52.7625,-178.3672 51.0124,-173.3672 49.2625,-178.3673 52.7625,-178.3672"></polygon>
</g>
<!-- 5&#45;&gt;7 -->
<g id="edge8" class="edge">
<title>5:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M336.0124,-203C336.0124,-203 336.0124,-178.3672 336.0124,-178.3672"></path>
<polygon fill="#000000" stroke="#000000" points="337.7625,-178.3672 336.0124,-173.3672 334.2625,-178.3673 337.7625,-178.3672"></polygon>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge11" class="edge">
<title>2:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M193.0124,-256C193.0124,-256 51.0124,-256 51.0124,-256 51.0124,-256 51.0124,-231.6393 51.0124,-231.6393"></path>
<polygon fill="#000000" stroke="#000000" points="52.7625,-231.6393 51.0124,-226.6393 49.2625,-231.6393 52.7625,-231.6393"></polygon>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge10" class="edge">
<title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M193.0124,-244.6C193.0124,-244.6 193.0124,-215 193.0124,-215 193.0124,-215 291.5585,-215 291.5585,-215"></path>
<polygon fill="#000000" stroke="#000000" points="291.5585,-216.7501 296.5585,-215 291.5584,-213.2501 291.5585,-216.7501"></polygon>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge12" class="edge">
<title>2:e-&gt;3</title>
<path fill="none" stroke="#000000" d="M236.0124,-256C236.0124,-256 245.7055,-256 245.7055,-256"></path>
<polygon fill="#000000" stroke="#000000" points="245.7056,-257.7501 250.7055,-256 245.7055,-254.2501 245.7056,-257.7501"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge13" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M193.0124,-286.2C193.0124,-286.2 193.0124,-273.2987 193.0124,-273.2987"></path>
<polygon fill="#000000" stroke="#000000" points="194.7625,-273.2987 193.0124,-268.2987 191.2625,-273.2987 194.7625,-273.2987"></polygon>
</g>
<!-- 13 -->
<g id="node1" class="node">
<title>13</title>
<polygon fill="#ffffff" stroke="#000000" points="233.2479,-23.4033 152.7769,-23.4033 152.7769,-.1967 233.2479,-.1967 233.2479,-23.4033"></polygon>
<text text-anchor="start" x="159.8948" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 67 items</text>
</g>
<!-- 12 -->
<g id="node2" class="node">
<title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="215.2394,-65.0033 170.7854,-65.0033 170.7854,-41.7967 215.2394,-41.7967 215.2394,-65.0033"></polygon>
<text text-anchor="start" x="177.8992" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">67 items</text>
</g>
<!-- 10 -->
<g id="node3" class="node">
<title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="102.0372,-113.2 -.0124,-113.2 -.0124,-83.2 102.0372,-83.2 102.0372,-113.2"></polygon>
<text text-anchor="start" x="7" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="7" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa now has 33 items</text>
</g>
<!-- 11 -->
<g id="node4" class="node">
<title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="389.803,-113.2 282.2218,-113.2 282.2218,-83.2 389.803,-83.2 389.803,-113.2"></polygon>
<text text-anchor="start" x="289.1172" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="289.1172" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">virginica now has 34 items</text>
</g>
<!-- 6 -->
<g id="node5" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="93.6445,-173.2 8.3803,-173.2 8.3803,-143.2 93.6445,-143.2 93.6445,-173.2"></polygon>
<text text-anchor="start" x="15.4464" y="-160" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="15.4464" y="-152" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa has 50 items</text>
</g>
<!-- 7 -->
<g id="node6" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="381.4101,-173.2 290.6147,-173.2 290.6147,-143.2 381.4101,-143.2 381.4101,-173.2"></polygon>
<text text-anchor="start" x="297.5636" y="-160" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="297.5636" y="-152" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">virginica has 50 items</text>
</g>
<!-- 8 -->
<g id="node7" class="node">
<title>8</title>
<polygon fill="#cccccc" stroke="#000000" points="276.8968,-185.2 107.128,-185.2 107.128,-131.2 276.8968,-131.2 276.8968,-185.2"></polygon>
<text text-anchor="start" x="114.3204" y="-172" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="114.3204" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">9 with petals &gt; 1 SD wider than the mean</text>
<text text-anchor="start" x="114.3204" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD longer than the mean</text>
<text text-anchor="start" x="114.3204" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with sepals &gt; 1 SD wider than the mean</text>
<text text-anchor="start" x="114.3204" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">10 with sepals &gt; 1 SD longer than the mean</text>
</g>
<!-- 9 -->
<g id="node8" class="node">
<title>9</title>
<polygon fill="#cccccc" stroke="#000000" points="560.4492,-185.2 395.5756,-185.2 395.5756,-131.2 560.4492,-131.2 560.4492,-185.2"></polygon>
<text text-anchor="start" x="402.544" y="-172" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="402.544" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD wider than the mean</text>
<text text-anchor="start" x="402.544" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD longer than the mean</text>
<text text-anchor="start" x="402.544" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">8 with sepals &gt; 1 SD wider than the mean</text>
<text text-anchor="start" x="402.544" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">8 with sepals &gt; 1 SD longer than the mean</text>
</g>
<!-- 4 -->
<g id="node9" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="90.4133,-226.6033 11.6115,-226.6033 11.6115,-203.3967 90.4133,-203.3967 90.4133,-226.6033"></polygon>
<text text-anchor="start" x="18.562" y="-212.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 5 -->
<g id="node10" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="375.4133,-226.6033 296.6115,-226.6033 296.6115,-203.3967 375.4133,-203.3967 375.4133,-226.6033"></polygon>
<text text-anchor="start" x="303.562" y="-212.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 2 -->
<g id="node11" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="236.4101,-268.2033 149.6147,-268.2033 149.6147,-244.9967 236.4101,-244.9967 236.4101,-268.2033"></polygon>
<text text-anchor="start" x="156.5636" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text>
</g>
<!-- 3 -->
<g id="node12" class="node">
<title>3</title>
<polygon fill="#cccccc" stroke="#000000" points="345.4631,-268.2033 250.5617,-268.2033 250.5617,-244.9967 345.4631,-244.9967 345.4631,-268.2033"></polygon>
<text text-anchor="start" x="257.7876" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 50 versicolor</text>
</g>
<!-- 1 -->
<g id="node13" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="217.1871,-309.8033 168.8377,-309.8033 168.8377,-286.5967 217.1871,-286.5967 217.1871,-309.8033"></polygon>
<text text-anchor="start" x="175.6756" y="-295.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text>
</g>
</g>
</svg>

<p>Exclusions produced like this are additive and the items may be
excluded by more than one exclusion criteria, and the list of exclusion
counts won’t necessarily add up to an exclusion total.</p>
<p>Sometimes inclusion criteria are more important. For this we use
<code>include_any</code> which works in a similar manner but INCLUDING
items which match ANY of the supplied criteria, essentially combining
the criteria with a logical OR operation, and in this case resulting in
very different result from our previous example.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dataset2 <span class="ot">=</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;starts with {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">include_any</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    Species<span class="sc">==</span><span class="st">&quot;versicolor&quot;</span> <span class="sc">~</span> <span class="st">&quot;{.included} versicolor&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span> <span class="sc">~</span> <span class="st">&quot;{.included} setosa&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(Species = forcats::fct_drop(Species)) %&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;{Species} has {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">include_any</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    Petal.Width <span class="sc">&lt;</span> <span class="fu">mean</span>(Petal.Width)<span class="sc">+</span><span class="fu">sd</span>(Petal.Width) <span class="sc">~</span> <span class="st">&quot;{.included} with petals &lt;= 1 SD wider than the mean&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    Petal.Length <span class="sc">&lt;</span> <span class="fu">mean</span>(Petal.Length)<span class="sc">+</span><span class="fu">sd</span>(Petal.Length) <span class="sc">~</span> <span class="st">&quot;{.included} with petals &lt;= 1 SD longer than the mean&quot;</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    Sepal.Width <span class="sc">&lt;</span> <span class="fu">mean</span>(Sepal.Width)<span class="sc">+</span><span class="fu">sd</span>(Sepal.Width) <span class="sc">~</span> <span class="st">&quot;{.included} with sepals &lt;= 1 SD wider than the mean&quot;</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    Sepal.Length <span class="sc">&lt;</span> <span class="fu">mean</span>(Sepal.Length)<span class="sc">+</span><span class="fu">sd</span>(Sepal.Length) <span class="sc">~</span> <span class="st">&quot;{.included} with sepals &lt;= 1 SD longer than the mean&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;{Species} now has {.count} items&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;ends with {.total} items&quot;</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>dataset2 <span class="sc">%&gt;%</span> <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="244.966pt" height="288.000pt" viewBox="0 0 244.966 288.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.662 0.662) rotate(0) translate(4 431.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-430.8 366.0552,-430.8 366.0552,4 -4,4"></polygon>
<!-- 12&#45;&gt;13 -->
<g id="edge1" class="edge">
<title>12:s-&gt;13</title>
<path fill="none" stroke="#000000" d="M181.0276,-41.4C181.0276,-41.4 181.0276,-28.4987 181.0276,-28.4987"></path>
<polygon fill="#000000" stroke="#000000" points="182.7777,-28.4987 181.0276,-23.4987 179.2777,-28.4987 182.7777,-28.4987"></polygon>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge3" class="edge">
<title>10:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M87.0276,-93C87.0276,-93 166.4848,-93 166.4848,-93 166.4848,-93 166.4848,-70.0671 166.4848,-70.0671"></path>
<polygon fill="#000000" stroke="#000000" points="168.2349,-70.0671 166.4848,-65.0671 164.7349,-70.0672 168.2349,-70.0671"></polygon>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge2" class="edge">
<title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M275.0276,-103C275.0276,-103 195.5704,-103 195.5704,-103 195.5704,-103 195.5704,-70.1545 195.5704,-70.1545"></path>
<polygon fill="#000000" stroke="#000000" points="197.3205,-70.1545 195.5704,-65.1545 193.8205,-70.1545 197.3205,-70.1545"></polygon>
</g>
<!-- 8&#45;&gt;10 -->
<g id="edge5" class="edge">
<title>8:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M87.0276,-131.2C87.0276,-131.2 87.0276,-118.5407 87.0276,-118.5407"></path>
<polygon fill="#000000" stroke="#000000" points="88.7777,-118.5407 87.0276,-113.5407 85.2777,-118.5407 88.7777,-118.5407"></polygon>
</g>
<!-- 9&#45;&gt;11 -->
<g id="edge4" class="edge">
<title>9:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M275.0276,-131.2C275.0276,-131.2 275.0276,-118.5407 275.0276,-118.5407"></path>
<polygon fill="#000000" stroke="#000000" points="276.7777,-118.5407 275.0276,-113.5407 273.2777,-118.5407 276.7777,-118.5407"></polygon>
</g>
<!-- 6&#45;&gt;8 -->
<g id="edge7" class="edge">
<title>6:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M87.0276,-211.2C87.0276,-211.2 87.0276,-198.2324 87.0276,-198.2324"></path>
<polygon fill="#000000" stroke="#000000" points="88.7777,-198.2324 87.0276,-193.2324 85.2777,-198.2325 88.7777,-198.2324"></polygon>
</g>
<!-- 7&#45;&gt;9 -->
<g id="edge6" class="edge">
<title>7:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M275.0276,-211.2C275.0276,-211.2 275.0276,-198.2324 275.0276,-198.2324"></path>
<polygon fill="#000000" stroke="#000000" points="276.7777,-198.2324 275.0276,-193.2324 273.2777,-198.2325 276.7777,-198.2324"></polygon>
</g>
<!-- 4&#45;&gt;6 -->
<g id="edge9" class="edge">
<title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M87.0276,-259C87.0276,-259 87.0276,-246.4477 87.0276,-246.4477"></path>
<polygon fill="#000000" stroke="#000000" points="88.7777,-246.4477 87.0276,-241.4477 85.2777,-246.4478 88.7777,-246.4477"></polygon>
</g>
<!-- 5&#45;&gt;7 -->
<g id="edge8" class="edge">
<title>5:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M275.0276,-259C275.0276,-259 275.0276,-246.4477 275.0276,-246.4477"></path>
<polygon fill="#000000" stroke="#000000" points="276.7777,-246.4477 275.0276,-241.4477 273.2777,-246.4478 276.7777,-246.4477"></polygon>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge11" class="edge">
<title>3:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M162.7074,-301.2C162.7074,-301.2 162.7074,-274 162.7074,-274 162.7074,-274 131.6407,-274 131.6407,-274"></path>
<polygon fill="#000000" stroke="#000000" points="131.6407,-272.2501 126.6407,-274 131.6406,-275.7501 131.6407,-272.2501"></polygon>
</g>
<!-- 3&#45;&gt;5 -->
<g id="edge10" class="edge">
<title>3:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M199.3478,-301.2C199.3478,-301.2 199.3478,-267 199.3478,-267 199.3478,-267 230.4145,-267 230.4145,-267"></path>
<polygon fill="#000000" stroke="#000000" points="230.4146,-268.7501 235.4145,-267 230.4145,-265.2501 230.4146,-268.7501"></polygon>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge12" class="edge">
<title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M181.0276,-361.4C181.0276,-361.4 181.0276,-348.6351 181.0276,-348.6351"></path>
<polygon fill="#000000" stroke="#000000" points="182.7777,-348.6351 181.0276,-343.6351 179.2777,-348.6351 182.7777,-348.6351"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge13" class="edge">
<title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M181.0276,-403C181.0276,-403 181.0276,-390.0987 181.0276,-390.0987"></path>
<polygon fill="#000000" stroke="#000000" points="182.7777,-390.0987 181.0276,-385.0987 179.2777,-390.0987 182.7777,-390.0987"></polygon>
</g>
<!-- 13 -->
<g id="node1" class="node">
<title>13</title>
<polygon fill="#ffffff" stroke="#000000" points="221.2631,-23.4033 140.7921,-23.4033 140.7921,-.1967 221.2631,-.1967 221.2631,-23.4033"></polygon>
<text text-anchor="start" x="147.91" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 99 items</text>
</g>
<!-- 12 -->
<g id="node2" class="node">
<title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="203.2546,-65.0033 158.8006,-65.0033 158.8006,-41.7967 203.2546,-41.7967 203.2546,-65.0033"></polygon>
<text text-anchor="start" x="165.9144" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">99 items</text>
</g>
<!-- 10 -->
<g id="node3" class="node">
<title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="138.0524,-113.2 36.0028,-113.2 36.0028,-83.2 138.0524,-83.2 138.0524,-113.2"></polygon>
<text text-anchor="start" x="43.0152" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="43.0152" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa now has 49 items</text>
</g>
<!-- 11 -->
<g id="node4" class="node">
<title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="331.2065,-113.2 218.8487,-113.2 218.8487,-83.2 331.2065,-83.2 331.2065,-113.2"></polygon>
<text text-anchor="start" x="225.6884" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="225.6884" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">versicolor now has 50 items</text>
</g>
<!-- 8 -->
<g id="node5" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="174.0828,-193.2 -.0276,-193.2 -.0276,-131.2 174.0828,-131.2 174.0828,-193.2"></polygon>
<text text-anchor="start" x="7" y="-180" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="7" y="-172" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text>
<text text-anchor="start" x="7" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">41 with petals &lt;= 1 SD wider than the mean</text>
<text text-anchor="start" x="7" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with petals &lt;= 1 SD longer than the mean</text>
<text text-anchor="start" x="7" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with sepals &lt;= 1 SD wider than the mean</text>
<text text-anchor="start" x="7" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">40 with sepals &lt;= 1 SD longer than the mean</text>
</g>
<!-- 9 -->
<g id="node6" class="node">
<title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="362.0828,-193.2 187.9724,-193.2 187.9724,-131.2 362.0828,-131.2 362.0828,-193.2"></polygon>
<text text-anchor="start" x="195" y="-180" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="195" y="-172" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text>
<text text-anchor="start" x="195" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">45 with petals &lt;= 1 SD wider than the mean</text>
<text text-anchor="start" x="195" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with petals &lt;= 1 SD longer than the mean</text>
<text text-anchor="start" x="195" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">42 with sepals &lt;= 1 SD wider than the mean</text>
<text text-anchor="start" x="195" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">41 with sepals &lt;= 1 SD longer than the mean</text>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="129.6597,-241.2 44.3955,-241.2 44.3955,-211.2 129.6597,-211.2 129.6597,-241.2"></polygon>
<text text-anchor="start" x="51.4616" y="-228" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="51.4616" y="-220" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa has 50 items</text>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="322.8134,-241.2 227.2418,-241.2 227.2418,-211.2 322.8134,-211.2 322.8134,-241.2"></polygon>
<text text-anchor="start" x="234.1348" y="-228" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="234.1348" y="-220" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">versicolor has 50 items</text>
</g>
<!-- 4 -->
<g id="node9" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="126.4285,-282.6033 47.6267,-282.6033 47.6267,-259.3967 126.4285,-259.3967 126.4285,-282.6033"></polygon>
<text text-anchor="start" x="54.5772" y="-268.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 5 -->
<g id="node10" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="314.4285,-282.6033 235.6267,-282.6033 235.6267,-259.3967 314.4285,-259.3967 314.4285,-282.6033"></polygon>
<text text-anchor="start" x="242.5772" y="-268.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 3 -->
<g id="node11" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="210.8646,-343.5005 151.1906,-343.5005 151.1906,-300.8995 210.8646,-300.8995 210.8646,-343.5005"></polygon>
<text text-anchor="start" x="158.3596" y="-329.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text>
<text text-anchor="start" x="158.3596" y="-319.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">50 versicolor</text>
<text text-anchor="start" x="158.3596" y="-310.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">50 setosa</text>
</g>
<!-- 2 -->
<g id="node12" class="node">
<title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="224.4253,-385.0033 137.6299,-385.0033 137.6299,-361.7967 224.4253,-361.7967 224.4253,-385.0033"></polygon>
<text text-anchor="start" x="144.5788" y="-371" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text>
</g>
<!-- 1 -->
<g id="node13" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="205.2023,-426.6033 156.8529,-426.6033 156.8529,-403.3967 205.2023,-403.3967 205.2023,-426.6033"></polygon>
<text text-anchor="start" x="163.6908" y="-412.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text>
</g>
</g>
</svg>

</div>
<div id="excluded-data" class="section level1">
<h1>Excluded data</h1>
<p>When considering a data pipeline it is sometimes important to know
what has been excluded and at what stage. This can help for debugging or
for addressing data quality issues. <code>dtrackr</code> can collect all
data excluded at the same time as the history graph, along with a record
of when in the pipeline and why an item was excluded. This behaviour is
enabled by the <code>capture_exclusions()</code> flag.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">track</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">capture_exclusions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exclude_all</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    Petal.Length <span class="sc">&gt;</span> <span class="fl">5.8</span> <span class="sc">~</span> <span class="st">&quot;{.excluded} long ones&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    Petal.Length <span class="sc">&lt;</span> <span class="fl">1.3</span> <span class="sc">~</span> <span class="st">&quot;{.excluded} short ones&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.stage =</span> <span class="st">&quot;petal length exclusion&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;leaving {.count}&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    Sepal.Length <span class="sc">&gt;=</span> <span class="fu">quantile</span>(Sepal.Length, <span class="fl">0.05</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.messages=</span><span class="st">&quot;removing {.count.in-.count.out} with sepals &lt; q 0.05&quot;</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.type =</span> <span class="st">&quot;comment&quot;</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.stage =</span> <span class="st">&quot;sepal length exclusion&quot;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;leaving {.count}&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exclude_all</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    Petal.Width <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">&quot;{.excluded} narrow ones&quot;</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    Petal.Width <span class="sc">&gt;</span> <span class="fl">2.1</span> <span class="sc">~</span> <span class="st">&quot;{.excluded} wide ones&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">comment</span>(<span class="st">&quot;leaving {.count}&quot;</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> <span class="fu">flowchart</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="424.800pt" height="213.561pt" viewBox="0 0 424.800 213.561" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.774 0.774) rotate(0) translate(4 272.000)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-272.4 545.3516,-272.4 545.3516,4 -4,4"></polygon>
<!-- 10&#45;&gt;16 -->
<g id="edge3" class="edge">
<title>10:s-&gt;16</title>
<path fill="none" stroke="#000000" d="M63.3488,-52C63.3488,-52 63.3488,-35.0493 63.3488,-35.0493"></path>
<polygon fill="#000000" stroke="#000000" points="65.0989,-35.0493 63.3488,-30.0493 61.5989,-35.0494 65.0989,-35.0493"></polygon>
</g>
<!-- 10&#45;&gt;13 -->
<g id="edge6" class="edge">
<title>10:e-&gt;13</title>
<path fill="none" stroke="#000000" d="M97.3488,-67C97.3488,-67 105.9753,-67 105.9753,-67"></path>
<polygon fill="#000000" stroke="#000000" points="105.9753,-68.7501 110.9753,-67 105.9752,-65.2501 105.9753,-68.7501"></polygon>
</g>
<!-- 11&#45;&gt;17 -->
<g id="edge2" class="edge">
<title>11:s-&gt;17</title>
<path fill="none" stroke="#000000" d="M233.3488,-52C233.3488,-52 233.3488,-35.0493 233.3488,-35.0493"></path>
<polygon fill="#000000" stroke="#000000" points="235.0989,-35.0493 233.3488,-30.0493 231.5989,-35.0494 235.0989,-35.0493"></polygon>
</g>
<!-- 11&#45;&gt;14 -->
<g id="edge5" class="edge">
<title>11:e-&gt;14</title>
<path fill="none" stroke="#000000" d="M272.3488,-67C272.3488,-67 281.8198,-67 281.8198,-67"></path>
<polygon fill="#000000" stroke="#000000" points="281.8198,-68.7501 286.8198,-67 281.8198,-65.2501 281.8198,-68.7501"></polygon>
</g>
<!-- 12&#45;&gt;18 -->
<g id="edge1" class="edge">
<title>12:s-&gt;18</title>
<path fill="none" stroke="#000000" d="M416.3488,-52C416.3488,-52 416.3488,-35.0493 416.3488,-35.0493"></path>
<polygon fill="#000000" stroke="#000000" points="418.0989,-35.0493 416.3488,-30.0493 414.5989,-35.0494 418.0989,-35.0493"></polygon>
</g>
<!-- 12&#45;&gt;15 -->
<g id="edge4" class="edge">
<title>12:e-&gt;15</title>
<path fill="none" stroke="#000000" d="M453.3488,-67C453.3488,-67 462.2848,-67 462.2848,-67"></path>
<polygon fill="#000000" stroke="#000000" points="462.2848,-68.7501 467.2848,-67 462.2847,-65.2501 462.2848,-68.7501"></polygon>
</g>
<!-- 7&#45;&gt;10 -->
<g id="edge9" class="edge">
<title>7:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M63.3488,-104C63.3488,-104 63.3488,-87.0493 63.3488,-87.0493"></path>
<polygon fill="#000000" stroke="#000000" points="65.0989,-87.0493 63.3488,-82.0493 61.5989,-87.0494 65.0989,-87.0493"></polygon>
</g>
<!-- 8&#45;&gt;11 -->
<g id="edge8" class="edge">
<title>8:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M233.3488,-104C233.3488,-104 233.3488,-87.0493 233.3488,-87.0493"></path>
<polygon fill="#000000" stroke="#000000" points="235.0989,-87.0493 233.3488,-82.0493 231.5989,-87.0494 235.0989,-87.0493"></polygon>
</g>
<!-- 9&#45;&gt;12 -->
<g id="edge7" class="edge">
<title>9:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M416.3488,-104C416.3488,-104 416.3488,-87.0493 416.3488,-87.0493"></path>
<polygon fill="#000000" stroke="#000000" points="418.0989,-87.0493 416.3488,-82.0493 414.5989,-87.0494 418.0989,-87.0493"></polygon>
</g>
<!-- 4&#45;&gt;7 -->
<g id="edge12" class="edge">
<title>4:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M63.3488,-151.8C63.3488,-151.8 63.3488,-139.2477 63.3488,-139.2477"></path>
<polygon fill="#000000" stroke="#000000" points="65.0989,-139.2477 63.3488,-134.2477 61.5989,-139.2478 65.0989,-139.2477"></polygon>
</g>
<!-- 5&#45;&gt;8 -->
<g id="edge11" class="edge">
<title>5:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M233.3488,-151.8C233.3488,-151.8 233.3488,-139.2477 233.3488,-139.2477"></path>
<polygon fill="#000000" stroke="#000000" points="235.0989,-139.2477 233.3488,-134.2477 231.5989,-139.2478 235.0989,-139.2477"></polygon>
</g>
<!-- 6&#45;&gt;9 -->
<g id="edge10" class="edge">
<title>6:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M416.3488,-151.8C416.3488,-151.8 416.3488,-139.2477 416.3488,-139.2477"></path>
<polygon fill="#000000" stroke="#000000" points="418.0989,-139.2477 416.3488,-134.2477 414.5989,-139.2478 418.0989,-139.2477"></polygon>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge15" class="edge">
<title>3:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M233.3488,-205C233.3488,-205 63.3488,-205 63.3488,-205 63.3488,-205 63.3488,-180.4961 63.3488,-180.4961"></path>
<polygon fill="#000000" stroke="#000000" points="65.0989,-180.496 63.3488,-175.4961 61.5989,-180.4961 65.0989,-180.496"></polygon>
</g>
<!-- 3&#45;&gt;5 -->
<g id="edge14" class="edge">
<title>3:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M233.3488,-193.4C233.3488,-193.4 233.3488,-180.4987 233.3488,-180.4987"></path>
<polygon fill="#000000" stroke="#000000" points="235.0989,-180.4987 233.3488,-175.4987 231.5989,-180.4987 235.0989,-180.4987"></polygon>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge13" class="edge">
<title>3:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M233.3488,-205C233.3488,-205 416.3488,-205 416.3488,-205 416.3488,-205 416.3488,-180.4961 416.3488,-180.4961"></path>
<polygon fill="#000000" stroke="#000000" points="418.0989,-180.496 416.3488,-175.4961 414.5989,-180.4961 418.0989,-180.496"></polygon>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge16" class="edge">
<title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M233.3488,-239.8C233.3488,-239.8 233.3488,-222.0463 233.3488,-222.0463"></path>
<polygon fill="#000000" stroke="#000000" points="235.0989,-222.0462 233.3488,-217.0463 231.5989,-222.0463 235.0989,-222.0462"></polygon>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge17" class="edge">
<title>1:e-&gt;2</title>
<path fill="none" stroke="#000000" d="M257.3488,-251C257.3488,-251 266.2707,-251 266.2707,-251"></path>
<polygon fill="#000000" stroke="#000000" points="266.2707,-252.7501 271.2707,-251 266.2706,-249.2501 266.2707,-252.7501"></polygon>
</g>
<!-- 16 -->
<g id="node1" class="node">
<title>16</title>
<polygon fill="#ffffff" stroke="#000000" points="97.5892,-30 29.1084,-30 29.1084,0 97.5892,0 97.5892,-30"></polygon>
<text text-anchor="start" x="36.2288" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="36.2288" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 39</text>
</g>
<!-- 17 -->
<g id="node2" class="node">
<title>17</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7425,-30 193.9551,-30 193.9551,0 272.7425,0 272.7425,-30"></polygon>
<text text-anchor="start" x="200.902" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="200.902" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 47</text>
</g>
<!-- 18 -->
<g id="node3" class="node">
<title>18</title>
<polygon fill="#ffffff" stroke="#000000" points="453.3544,-30 379.3432,-30 379.3432,0 453.3544,0 453.3544,-30"></polygon>
<text text-anchor="start" x="386.346" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="386.346" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 24</text>
</g>
<!-- 10 -->
<g id="node4" class="node">
<title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="97.5892,-82 29.1084,-82 29.1084,-52 97.5892,-52 97.5892,-82"></polygon>
<text text-anchor="start" x="36.2288" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="36.2288" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 43</text>
</g>
<!-- 11 -->
<g id="node5" class="node">
<title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7425,-82 193.9551,-82 193.9551,-52 272.7425,-52 272.7425,-82"></polygon>
<text text-anchor="start" x="200.902" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="200.902" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 47</text>
</g>
<!-- 12 -->
<g id="node6" class="node">
<title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="453.3544,-82 379.3432,-82 379.3432,-52 453.3544,-52 453.3544,-82"></polygon>
<text text-anchor="start" x="386.346" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="386.346" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 35</text>
</g>
<!-- 13 -->
<g id="node7" class="node">
<title>13</title>
<polygon fill="#cccccc" stroke="#000000" points="179.5892,-86 111.1084,-86 111.1084,-48 179.5892,-48 179.5892,-86"></polygon>
<text text-anchor="start" x="118.2288" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="118.2288" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">4 narrow ones</text>
<text text-anchor="start" x="118.2288" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 wide ones</text>
</g>
<!-- 14 -->
<g id="node8" class="node">
<title>14</title>
<polygon fill="#cccccc" stroke="#000000" points="365.7425,-86 286.9551,-86 286.9551,-48 365.7425,-48 365.7425,-86"></polygon>
<text text-anchor="start" x="293.902" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="293.902" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 narrow ones</text>
<text text-anchor="start" x="293.902" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 wide ones</text>
</g>
<!-- 15 -->
<g id="node9" class="node">
<title>15</title>
<polygon fill="#cccccc" stroke="#000000" points="541.3544,-86 467.3432,-86 467.3432,-48 541.3544,-48 541.3544,-86"></polygon>
<text text-anchor="start" x="474.346" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="474.346" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 narrow ones</text>
<text text-anchor="start" x="474.346" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">11 wide ones</text>
</g>
<!-- 7 -->
<g id="node10" class="node">
<title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="126.5468,-134 .1508,-134 .1508,-104 126.5468,-104 126.5468,-134"></polygon>
<text text-anchor="start" x="7" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text>
<text text-anchor="start" x="7" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 3 with sepals &lt; q 0.05</text>
</g>
<!-- 8 -->
<g id="node11" class="node">
<title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="296.5468,-134 170.1508,-134 170.1508,-104 296.5468,-104 296.5468,-134"></polygon>
<text text-anchor="start" x="177" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text>
<text text-anchor="start" x="177" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 3 with sepals &lt; q 0.05</text>
</g>
<!-- 9 -->
<g id="node12" class="node">
<title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="479.5468,-134 353.1508,-134 353.1508,-104 479.5468,-104 479.5468,-134"></polygon>
<text text-anchor="start" x="360" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text>
<text text-anchor="start" x="360" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 2 with sepals &lt; q 0.05</text>
</g>
<!-- 4 -->
<g id="node13" class="node">
<title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="102.7497,-175.4033 23.9479,-175.4033 23.9479,-152.1967 102.7497,-152.1967 102.7497,-175.4033"></polygon>
<text text-anchor="start" x="30.8984" y="-161.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 5 -->
<g id="node14" class="node">
<title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7497,-175.4033 193.9479,-175.4033 193.9479,-152.1967 272.7497,-152.1967 272.7497,-175.4033"></polygon>
<text text-anchor="start" x="200.8984" y="-161.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 6 -->
<g id="node15" class="node">
<title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="455.7497,-175.4033 376.9479,-175.4033 376.9479,-152.1967 455.7497,-152.1967 455.7497,-175.4033"></polygon>
<text text-anchor="start" x="383.8984" y="-161.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text>
</g>
<!-- 3 -->
<g id="node16" class="node">
<title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="260.7529,-217.0033 205.9447,-217.0033 205.9447,-193.7967 260.7529,-193.7967 260.7529,-217.0033"></polygon>
<text text-anchor="start" x="212.8968" y="-203" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 133</text>
</g>
<!-- 1 -->
<g id="node17" class="node">
<title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="257.5235,-263.4033 209.1741,-263.4033 209.1741,-240.1967 257.5235,-240.1967 257.5235,-263.4033"></polygon>
<text text-anchor="start" x="216.012" y="-249.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text>
</g>
<!-- 2 -->
<g id="node18" class="node">
<title>2</title>
<polygon fill="#cccccc" stroke="#000000" points="331.1483,-268.5006 271.5493,-268.5006 271.5493,-235.0994 331.1483,-235.0994 331.1483,-268.5006"></polygon>
<text text-anchor="start" x="278.4492" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">13 long ones</text>
<text text-anchor="start" x="278.4492" y="-244.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">4 short ones</text>
</g>
</g>
</svg>

<p>Give the previous data pipeline we can identify the items that were
excluded, the stage of the pipeline at which they were excluded and
details of the code that resulted in them being excluded.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> <span class="fu">excluded</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 40 × 9</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .stage        .strata .mess…¹ Sepal…² Sepal…³ Petal…⁴ Petal…⁵ Species .filter</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;         &lt;chr&gt;   &lt;glue&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 petal length… &quot;&quot;      13 lon… 6.3     3.3     6       2.5     virgin… Petal.…</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 petal length… &quot;&quot;      13 lon… 7.1     3       5.9     2.1     virgin… Petal.…</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 petal length… &quot;&quot;      13 lon… 7.6     3       6.6     2.1     virgin… Petal.…</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 petal length… &quot;&quot;      13 lon… 7.3     2.9     6.3     1.8     virgin… Petal.…</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 petal length… &quot;&quot;      13 lon… 7.2     3.6     6.1     2.5     virgin… Petal.…</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 petal length… &quot;&quot;      13 lon… 7.7     3.8     6.7     2.2     virgin… Petal.…</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 petal length… &quot;&quot;      13 lon… 7.7     2.6     6.9     2.3     virgin… Petal.…</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 petal length… &quot;&quot;      13 lon… 7.7     2.8     6.7     2       virgin… Petal.…</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 petal length… &quot;&quot;      13 lon… 7.2     3.2     6       1.8     virgin… Petal.…</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 petal length… &quot;&quot;      13 lon… 7.4     2.8     6.1     1.9     virgin… Petal.…</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 30 more rows, and abbreviated variable names ¹​.message, ²​Sepal.Length,</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ³​Sepal.Width, ⁴​Petal.Length, ⁵​Petal.Width</span></span></code></pre></div>
</div>
<div id="advanced-handling-of-the-history-graph." class="section level1">
<h1>Advanced handling of the history graph.</h1>
<p>The history graph is a stored as an attribute on a tracked dataframe.
The contents of this attribute is a list of dataframes including an edge
list and node list. These can be imported into other graph processing
packages, and visualised in different ways. Alternatively they could be
used for automated testing of data pipelines, for example.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">=</span> tmp <span class="sc">%&gt;%</span> <span class="fu">p_get</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the nodes, .id is a graph unique identifier</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tmp2<span class="sc">$</span>nodes <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 18</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .id     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .rank   &lt;dbl&gt; 1, 1, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .strata &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;Species:setosa&quot;, &quot;Species:versicolor&quot;, &quot;Species:v…</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .label  &lt;chr&gt; &quot;150 items&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&quot;, &quot;13 long ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;…</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .type   &lt;chr&gt; &quot;info&quot;, &quot;exclusion&quot;, &quot;info&quot;, &quot;stratify&quot;, &quot;stratify&quot;, &quot;stratify…</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .stage  &lt;chr&gt; &quot;&quot;, &quot;petal length exclusion&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;sepal length ex…</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the edges, .to and .from are foreign keys for .id</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>tmp2<span class="sc">$</span>edges <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 17</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 5</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .to          &lt;dbl&gt; 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .from        &lt;dbl&gt; 1, 1, 3, 3, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 10, 11, 12</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .rel         &lt;chr&gt; &quot;exclusion&quot;, &quot;info&quot;, &quot;stratify&quot;, &quot;stratify&quot;, &quot;stratify&quot;, …</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .strata      &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;Species:setosa&quot;, &quot;Species:versicolor&quot;, &quot;Species:…</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ .strata.prev &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;Species:setosa&quot;, &quot;Species:versicolor…</span></span></code></pre></div>
<p>The <code>GraphViz</code> language provides many options for
formatting the flowchart. Rather than try and provide an interface for
them, we have gone for sane defaults. If you want to change this or use
a different layout engine the <code>GraphViz</code> output can be
retrieved and edited directly. Alternatively if the output you need is
different, rendered SVG output can be edited by hand.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(tmp <span class="sc">%&gt;%</span> <span class="fu">p_get_as_dot</span>())</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; digraph {</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      graph [layout = &#39;dot&#39;,</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         splines=&#39;ortho&#39;,</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         rankdir = &#39;TB&#39;,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         outputorder = &#39;edgesfirst&#39;,</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bgcolor = &#39;white&#39;,</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         ranksep = &#39;0.25&#39;,</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         nodesep = &#39;0.2&#39;,</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         newrank=&#39;true&#39;]</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     node [fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         fontsize = &#39;8&#39;,</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         shape=&#39;box&#39;,</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         fixedsize = &#39;false&#39;,</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         margin = &#39;0.1,0.1&#39;,</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         width = &#39;0&#39;,</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         height = &#39;0&#39;,</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         style = &#39;filled&#39;,</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         color = &#39;black&#39;,</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         fontcolor = &#39;black&#39;,</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         labeljust=&#39;l&#39;]</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     edge [fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         fontsize = &#39;8&#39;,</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         len = &#39;0.5&#39;,</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         color = &#39;black&#39;,</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         arrowsize = &#39;0.5&#39;]</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;16&#39; [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 39&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:setosa&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;17&#39; [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 47&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:versicolor&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;18&#39; [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 24&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:virginica&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;10&#39; [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 43&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:setosa&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;11&#39; [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 47&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:versicolor&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;12&#39; [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;leaving 35&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:virginica&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;13&#39; [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;4 narrow ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;0 wide ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:setosa&#39;,fillcolor=&#39;grey80&#39;];</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;14&#39; [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;0 narrow ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;0 wide ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:versicolor&#39;,fillcolor=&#39;grey80&#39;];</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;15&#39; [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;0 narrow ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;11 wide ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:virginica&#39;,fillcolor=&#39;grey80&#39;];</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;7&#39; [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;removing 3 with sepals &amp;lt; q 0.05&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:setosa&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;8&#39; [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;removing 3 with sepals &amp;lt; q 0.05&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:versicolor&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;9&#39; [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN=&#39;LEFT&#39;/&gt;removing 2 with sepals &amp;lt; q 0.05&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:virginica&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;4&#39; [label=&lt;stratify by Species&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:setosa&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;5&#39; [label=&lt;stratify by Species&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:versicolor&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;6&#39; [label=&lt;stratify by Species&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;Species:virginica&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;3&#39; [label=&lt;leaving 133&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; { rank=&#39;same&#39;;</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;1&#39; [label=&lt;150 items&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;&#39;,fillcolor=&#39;white&#39;];</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;2&#39; [label=&lt;13 long ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;4 short ones&lt;BR ALIGN=&#39;LEFT&#39;/&gt;&gt;,group=&#39;&#39;,fillcolor=&#39;grey80&#39;];</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;12&#39; -&gt; &#39;18&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;11&#39; -&gt; &#39;17&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;10&#39; -&gt; &#39;16&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;12&#39; -&gt; &#39;15&#39; [tailport=&#39;e&#39;,weight=&#39;1&#39;]</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;11&#39; -&gt; &#39;14&#39; [tailport=&#39;e&#39;,weight=&#39;1&#39;]</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;10&#39; -&gt; &#39;13&#39; [tailport=&#39;e&#39;,weight=&#39;1&#39;]</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;9&#39; -&gt; &#39;12&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;8&#39; -&gt; &#39;11&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;7&#39; -&gt; &#39;10&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;6&#39; -&gt; &#39;9&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;5&#39; -&gt; &#39;8&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;4&#39; -&gt; &#39;7&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;3&#39; -&gt; &#39;6&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;3&#39; -&gt; &#39;5&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;3&#39; -&gt; &#39;4&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;1&#39; -&gt; &#39;3&#39; [tailport=&#39;s&#39;,weight=&#39;100&#39;]</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;1&#39; -&gt; &#39;2&#39; [tailport=&#39;e&#39;,weight=&#39;1&#39;]</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
</div>
<div id="combined-data-flows" class="section level1">
<h1>Combined data flows</h1>
<p>Data sets that undergo different processing may be joined into a
single dataset. This is supported in <code>dtrackr</code> and
demonstrated in the “joining-pipelines” vignette.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
